<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>TUSK • Start</title>
  <script defer src="../lib/db.js"></script>
  <style>
    body { font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
    .dock a { padding: 8px 12px; border: 1px solid #ddd; border-radius: 8px; text-decoration: none; margin-right: 8px; }
    .dock { margin: 12px 0 20px; }
  </style>
</head>
<body>
  <h1>TUSK-OS (Static v0)</h1>
  <p>Company: <strong id="company">—</strong> · Currency: <strong id="currency">—</strong></p>
  <div class="dock">
    <a href="settings.html">Settings</a>
    <a href="crm.html">CRM</a>
  </div>

  <h3>Database</h3>
  <button id="export">Export DB (.sqlite)</button>
  <input id="import" type="file" accept=".sqlite,application/octet-stream" />
  <p id="status"></p>

  <script>
    (async () => {
      await TuskDB.ready();
      const cfg = TuskDB.getSettings();
      document.getElementById('company').textContent = cfg.company || '—';
      document.getElementById('currency').textContent = cfg.currency || '—';

      document.getElementById('export').onclick = async () => {
        const bytes = await TuskDB.export();
        const blob = new Blob([bytes], { type: 'application/x-sqlite3' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'tusk.sqlite';
        a.click();
        URL.revokeObjectURL(a.href);
        document.getElementById('status').textContent = "Exported tusk.sqlite";
      };

      document.getElementById('import').onchange = async (e) => {
        const file = e.target.files?.[0];
        if (!file) return;
        const buf = await file.arrayBuffer();
        await TuskDB.import(new Uint8Array(buf));
        document.getElementById('status').textContent = "Imported DB · Reload CRM to see changes.";
      };
    })();
  </script>
</body>
</html>
